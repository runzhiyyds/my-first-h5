(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&d(g)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}})();const a=["/src/assets/party/bg-party-1.jpg","/src/assets/party/bg-party-2.jpg","/src/assets/party/bg-dancer.jpg"],l=["/src/assets/party/bg-food.jpg","/src/assets/party/bg-food-2.jpg"],b=document.getElementById("bg-top"),f=document.getElementById("bg-bottom"),E=document.getElementById("eventBox"),x=document.getElementById("startBtn"),I=document.getElementById("endingBox"),w=document.getElementById("luxuryBar"),L=document.getElementById("angerBar"),A=document.getElementById("budgetBar"),N=document.getElementById("luxuryNum"),P=document.getElementById("angerNum"),T=document.getElementById("budgetNum");let s=50,i=50,u=60,B=0,y=0;function $(){w.style.width=s+"%",L.style.width=i+"%",A.style.width=u+"%",N.textContent=s,P.textContent=i,T.textContent=u}function C(t){b.style.backgroundImage=`url('${t}')`,b.style.transform="scale(1.05)",setTimeout(()=>b.style.transform="scale(1)",1e3)}function S(t){f.style.backgroundImage=`url('${t}')`,f.style.transform="scale(1.05)",setTimeout(()=>f.style.transform="scale(1)",1e3)}const r=document.getElementById("particleCanvas"),m=r.getContext("2d");let h=[];function v(){r.width=window.innerWidth,r.height=window.innerHeight,h=[];for(let t=0;t<60;t++)h.push({x:Math.random()*r.width,y:Math.random()*r.height,r:Math.random()*2+1,dx:(Math.random()-.5)*.3,dy:(Math.random()-.5)*.3,alpha:Math.random()*.6+.3})}window.addEventListener("resize",v);v();function M(){m.clearRect(0,0,r.width,r.height),h.forEach(t=>{m.globalAlpha=t.alpha,m.fillStyle="#ffd98a",m.beginPath(),m.arc(t.x,t.y,t.r,0,Math.PI*2),m.fill(),t.x+=t.dx,t.y+=t.dy,(t.x<0||t.x>r.width)&&(t.dx*=-1),(t.y<0||t.y>r.height)&&(t.dy*=-1)}),requestAnimationFrame(M)}M();const j=[[{text:"派对舞者希望在巨型马提尼杯中加入烟雾机，成本略高。",topImg:a[2],bottomImg:l[0],options:[{label:"批准（奢华 +20，预算 -10，愤怒 +10）",l:20,b:-10,a:10},{label:"拒绝（奢华 -15）",l:-15,b:0,a:0}]},{text:"食品援助点传来消息：今日补给不足，排队人数激增。",topImg:a[0],bottomImg:l[1],options:[{label:"紧急援助（预算 -15，愤怒 -20）",l:0,b:-15,a:-20},{label:"无视（愤怒 +20）",l:0,b:0,a:20}]},{text:"宴会宾客希望增加灯光秀，预算再次超支。",topImg:a[1],bottomImg:l[1],options:[{label:"同意（奢华 +15，预算 -10，愤怒 +10）",l:15,b:-10,a:10},{label:"拒绝（奢华 -10）",l:-10,b:0,a:0}]}],[{text:"宴会上某位重要来宾希望安排私人合影位置。",topImg:a[0],bottomImg:l[0],options:[{label:"安排专门团队（奢华 +10，预算 -8）",l:10,b:-8,a:0},{label:"拒绝（奢华 -15）",l:-15,b:0,a:0}]},{text:"空管员无薪上班压力增大，航班延误恶化。",topImg:a[1],bottomImg:l[1],options:[{label:"拨款补贴（预算 -20，愤怒 -25）",l:0,b:-20,a:-25},{label:"不管（愤怒 +15）",l:0,b:0,a:15}]},{text:"宴会的甜品区遭遇排队混乱，需要扩大供应。",topImg:a[2],bottomImg:l[0],options:[{label:"扩充供应（奢华 +15，预算 -12）",l:15,b:-12,a:0},{label:"维持现状（奢华 -10）",l:-10,b:0,a:0}]}],[{text:"宴会视频被曝光到社交媒体，引发巨大讨论。",topImg:a[1],bottomImg:l[1],options:[{label:"发布声明（奢华 -10，愤怒 -5）",l:-10,b:0,a:-5},{label:"忽略（愤怒 +15）",l:0,b:0,a:15}]},{text:"食品援助组织发出公开警告：部分地区将断供。",topImg:a[0],bottomImg:l[0],options:[{label:"追加紧急拨款（预算 -20，愤怒 -30）",l:0,b:-20,a:-30},{label:"等待进一步评估（愤怒 +25）",l:0,b:0,a:25}]},{text:"城市出现抗议活动，要求恢复公共服务。",topImg:a[2],bottomImg:l[1],options:[{label:"安抚市民（预算 -10，愤怒 -10）",l:0,b:-10,a:-10},{label:"强行驱散（愤怒 +35）",l:0,b:0,a:35}]}]];function p(){const t=j[B];if(!t){H();return}const e=t[y];if(!e){B++,y=0,p();return}C(e.topImg),S(e.bottomImg),E.innerHTML=`
    <div class="event-text">${e.text}</div>
    ${e.options.map((c,d)=>`<button class="btn" data-idx="${d}">${c.label}</button>`).join("")}
  `,document.querySelectorAll(".btn").forEach(c=>{c.addEventListener("click",()=>{const d=c.getAttribute("data-idx");O(e.options[d]),y++,p()})})}function O(t){s+=t.l,i+=t.a,u+=t.b,s=Math.max(0,Math.min(100,s)),i=Math.max(0,Math.min(100,i)),u=Math.max(0,Math.min(100,u)),$()}function H(){let t="",e="";s>80&&i>90?(t="你的宴会灯火辉煌，但现实在你脚下崩塌。",e="#ff9a9a"):s>40&&i<60&&u>0?(t="你在撕裂的现实里走出了艰难而脆弱的平衡。",e="#ffe9b0"):(t="你失去了宴会，也失去了民心。",e="#9ab7ff"),I.innerHTML=`
    <div style="color:${e}; font-weight:600; line-height:1.6;">
      ${t}
    </div>
  `,I.classList.remove("hidden"),E.innerHTML=""}x.addEventListener("click",()=>{x.remove(),p()});
